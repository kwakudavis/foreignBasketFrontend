!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app-compat"),require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app-compat","@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase,t.firebase.INTERNAL.modularAPIs)}(this,function(be,_e){"use strict";try{!function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e=t(be),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function a(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||((r=r||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}var i,s=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(o,i=Error),o);function o(t,e,n){e=i.call(this,e)||this;return e.code=t,e.customData=n,e.name="FirebaseError",Object.setPrototypeOf(e,o.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,c.prototype.create),e}var c=(n.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(u,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new s(o,t,i)},n);function n(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var u=/\{\$([^}]+)}/g;var l,p=(f.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},f.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},f.prototype.setServiceProps=function(t){return this.serviceProps=t,this},f.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},f);function f(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}(v=l=l||{})[v.DEBUG=0]="DEBUG",v[v.VERBOSE=1]="VERBOSE",v[v.INFO=2]="INFO",v[v.WARN=3]="WARN",v[v.ERROR=4]="ERROR",v[v.SILENT=5]="SILENT";function d(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=m[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+i+"]  "+t.name+":"],n))}}var h={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},g=l.INFO,m=((P={})[l.DEBUG]="log",P[l.VERBOSE]="log",P[l.INFO]="info",P[l.WARN]="warn",P[l.ERROR]="error",P),v=(Object.defineProperty(y.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),y.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?h[t]:t},Object.defineProperty(y.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),y.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,l.DEBUG],t)),this._logHandler.apply(this,a([this,l.DEBUG],t))},y.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,l.VERBOSE],t)),this._logHandler.apply(this,a([this,l.VERBOSE],t))},y.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,l.INFO],t)),this._logHandler.apply(this,a([this,l.INFO],t))},y.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,l.WARN],t)),this._logHandler.apply(this,a([this,l.WARN],t))},y.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,l.ERROR],t)),this._logHandler.apply(this,a([this,l.ERROR],t))},y);function y(t){this.name=t,this._logLevel=g,this._logHandler=d,this._userLogHandler=null}function b(n){return new Promise(function(t,e){n.onsuccess=function(){t(n.result)},n.onerror=function(){e(n.error)}})}function _(n,r,i){var o,t=new Promise(function(t,e){b(o=n[r].apply(n,i)).then(t,e)});return t.request=o,t}function w(t,n,e){e.forEach(function(e){Object.defineProperty(t.prototype,e,{get:function(){return this[n][e]},set:function(t){this[n][e]=t}})})}function E(e,n,r,t){t.forEach(function(t){t in r.prototype&&(e.prototype[t]=function(){return _(this[n],t,arguments)})})}function I(e,n,r,t){t.forEach(function(t){t in r.prototype&&(e.prototype[t]=function(){return this[n][t].apply(this[n],arguments)})})}function T(t,r,e,n){n.forEach(function(n){n in e.prototype&&(t.prototype[n]=function(){return t=this[r],(e=_(t,n,arguments)).then(function(t){if(t)return new N(t,e.request)});var t,e})})}function S(t){this._index=t}function N(t,e){this._cursor=t,this._request=e}function O(t){this._store=t}function A(n){this._tx=n,this.complete=new Promise(function(t,e){n.oncomplete=function(){t()},n.onerror=function(){e(n.error)},n.onabort=function(){e(n.error)}})}function k(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new A(n)}function C(t){this._db=t}w(S,"_index",["name","keyPath","multiEntry","unique"]),E(S,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),T(S,"_index",IDBIndex,["openCursor","openKeyCursor"]),w(N,"_cursor",["direction","key","primaryKey","value"]),E(N,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(N.prototype[n]=function(){var e=this,t=arguments;return Promise.resolve().then(function(){return e._cursor[n].apply(e._cursor,t),b(e._request).then(function(t){if(t)return new N(t,e._request)})})})}),O.prototype.createIndex=function(){return new S(this._store.createIndex.apply(this._store,arguments))},O.prototype.index=function(){return new S(this._store.index.apply(this._store,arguments))},w(O,"_store",["name","keyPath","indexNames","autoIncrement"]),E(O,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),T(O,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),I(O,"_store",IDBObjectStore,["deleteIndex"]),A.prototype.objectStore=function(){return new O(this._tx.objectStore.apply(this._tx,arguments))},w(A,"_tx",["objectStoreNames","mode"]),I(A,"_tx",IDBTransaction,["abort"]),k.prototype.createObjectStore=function(){return new O(this._db.createObjectStore.apply(this._db,arguments))},w(k,"_db",["name","version","objectStoreNames"]),I(k,"_db",IDBDatabase,["deleteObjectStore","close"]),C.prototype.transaction=function(){return new A(this._db.transaction.apply(this._db,arguments))},w(C,"_db",["name","version","objectStoreNames"]),I(C,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[O,S].forEach(function(t){i in t.prototype&&(t.prototype[i.replace("open","iterate")]=function(){var t=(n=arguments,Array.prototype.slice.call(n)),e=t[t.length-1],n=this._store||this._index,r=n[i].apply(n,t.slice(0,-1));r.onsuccess=function(){e(r.result)}})})}),[S,O].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,n){var r=this,i=[];return new Promise(function(e){r.iterateCursor(t,function(t){t?(i.push(t.value),void 0===n||i.length!=n?t.continue():e(i)):e(i)})})})});var P="0.5.0";const R=1e4,M=`w:${P}`,j="FIS_v2",B="https://firebaseinstallations.googleapis.com/v1",D=36e5;const L=new c("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function U(t){return t instanceof s&&t.code.includes("request-failed")}function q({projectId:t}){return`${B}/projects/${t}/installations`}function x(t){return{token:t.token,requestStatus:2,expiresIn:(t=t.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()}}async function F(t,e){e=(await e.json()).error;return L.create("request-failed",{requestName:t,serverCode:e.code,serverMessage:e.message,serverStatus:e.status})}function $({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function H(t,{refreshToken:e}){const n=$(t);return n.append("Authorization",(e=e,`${j} ${e}`)),n}async function V(t){var e=await t();return 500<=e.status&&e.status<600?t():e}function K(e){return new Promise(t=>{setTimeout(t,e)})}const W=/^[cdef][\w-]{21}$/,z="";function G(){try{const e=new Uint8Array(17),n=self.crypto||self.msCrypto;n.getRandomValues(e),e[0]=112+e[0]%16;var t=function(t){const e=function(t){const e=btoa(String.fromCharCode(...t));return e.replace(/\+/g,"-").replace(/\//g,"_")}(t);return e.substr(0,22)}(e);return W.test(t)?t:z}catch(t){return z}}function J(t){return`${t.appName}!${t.appId}`}const Y=new Map;function Z(t,e){t=J(t);Q(t,e),function(t,e){const n=function(){!X&&"BroadcastChannel"in self&&(X=new BroadcastChannel("[Firebase] FID Change"),X.onmessage=t=>{Q(t.data.key,t.data.fid)});return X}();n&&n.postMessage({key:t,fid:e});0===Y.size&&X&&(X.close(),X=null)}(t,e)}function Q(t,e){t=Y.get(t);if(t)for(const n of t)n(e)}let X=null;const tt="firebase-installations-store";let et=null;function nt(){var t,e,n;return et=et||(t=1,e=t=>{0===t.oldVersion&&t.createObjectStore(tt)},(n=(t=_(indexedDB,"open",["firebase-installations-database",t])).request)&&(n.onupgradeneeded=function(t){e&&e(new k(n.result,t.oldVersion,n.transaction))}),t.then(function(t){return new C(t)})),et}async function rt(t,e){var n=J(t);const r=await nt(),i=r.transaction(tt,"readwrite"),o=i.objectStore(tt);var a=await o.get(n);return await o.put(e,n),await i.complete,a&&a.fid===e.fid||Z(t,e.fid),e}async function it(t){t=J(t);const e=await nt(),n=e.transaction(tt,"readwrite");await n.objectStore(tt).delete(t),await n.complete}async function ot(t,e){var n=J(t);const r=await nt(),i=r.transaction(tt,"readwrite"),o=i.objectStore(tt);var a=await o.get(n),e=e(a);return void 0===e?await o.delete(n):await o.put(e,n),await i.complete,!e||a&&a.fid===e.fid||Z(t,e.fid),e}async function at(e){let n;var t=await ot(e,t=>{t=function(t){t=t||{fid:G(),registrationStatus:0};return ct(t)}(t),t=function(t,e){{if(0!==e.registrationStatus)return 1===e.registrationStatus?{installationEntry:e,registrationPromise:async function(t){let e=await st(t);for(;1===e.registrationStatus;)await K(100),e=await st(t);if(0!==e.registrationStatus)return e;{var{installationEntry:n,registrationPromise:r}=await at(t);return r||n}}(t)}:{installationEntry:e};if(!navigator.onLine){var n=Promise.reject(L.create("app-offline"));return{installationEntry:e,registrationPromise:n}}e={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},t=async function(e,n){try{var t=await async function(t,{fid:e}){const n=q(t);var r=$(t),t={fid:e,authVersion:j,appId:t.appId,sdkVersion:M};const i={method:"POST",headers:r,body:JSON.stringify(t)},o=await V(()=>fetch(n,i));if(o.ok){t=await o.json();return{fid:t.fid||e,registrationStatus:2,refreshToken:t.refreshToken,authToken:x(t.authToken)}}throw await F("Create Installation",o)}(e,n);return rt(e,t)}catch(t){throw U(t)&&409===t.customData.serverCode?await it(e):await rt(e,{fid:n.fid,registrationStatus:0}),t}}(t,e);return{installationEntry:e,registrationPromise:t}}}(e,t);return n=t.registrationPromise,t.installationEntry});return t.fid===z?{installationEntry:await n}:{installationEntry:t,registrationPromise:n}}function st(t){return ot(t,t=>{if(!t)throw L.create("installation-not-found");return ct(t)})}function ct(t){return 1===(e=t).registrationStatus&&e.registrationTime+R<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function ut({appConfig:t,platformLoggerProvider:e},n){const r=([i,o]=[t,n["fid"]],`${q(i)}/${o}/authTokens:generate`);var i,o;const a=H(t,n),s=e.getImmediate({optional:!0});s&&a.append("x-firebase-client",s.getPlatformInfoString());e={installation:{sdkVersion:M}};const c={method:"POST",headers:a,body:JSON.stringify(e)},u=await V(()=>fetch(r,c));if(u.ok)return x(await u.json());throw await F("Generate Auth Token",u)}async function lt(r,i=!1){let o;var t=await ot(r.appConfig,t=>{if(!ft(t))throw L.create("not-registered");var e,n=t.authToken;if(i||2!==(e=n).requestStatus||function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+D}(e)){if(1===n.requestStatus)return o=async function(t,e){let n=await pt(t.appConfig);for(;1===n.authToken.requestStatus;)await K(100),n=await pt(t.appConfig);var r=n.authToken;return 0===r.requestStatus?lt(t,e):r}(r,i),t;if(!navigator.onLine)throw L.create("app-offline");n=(e=t,n={requestStatus:1,requestTime:Date.now()},Object.assign(Object.assign({},e),{authToken:n}));return o=async function(e,n){try{var t=await ut(e,n),r=Object.assign(Object.assign({},n),{authToken:t});return await rt(e.appConfig,r),t}catch(t){throw!U(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode?(n=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),await rt(e.appConfig,n)):await it(e.appConfig),t}}(r,n),n}return t});return o?await o:t.authToken}function pt(t){return ot(t,t=>{if(!ft(t))throw L.create("not-registered");var e=t.authToken;return 1===(e=e).requestStatus&&e.requestTime+R<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}function ft(t){return void 0!==t&&2===t.registrationStatus}async function dt(t,e=!1){var n=t;return await((t=(await at(t=n.appConfig)).registrationPromise)&&await t),(await lt(n,e)).token}function ht(t){return L.create("missing-app-config-values",{valueName:t})}const gt="installations",mt=t=>{t=t.getProvider("app").getImmediate();return{app:t,appConfig:function(t){if(!t||!t.options)throw ht("App Configuration");if(!t.name)throw ht("App Name");for(const e of["projectId","apiKey","appId"])if(!t.options[e])throw ht(e);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(t),platformLoggerProvider:_e._getProvider(t,"platform-logger"),_delete:()=>Promise.resolve()}},vt=t=>{t=t.getProvider("app").getImmediate();const e=_e._getProvider(t,gt).getImmediate();return{getId:()=>async function(t){const{installationEntry:e,registrationPromise:n}=await at(t.appConfig);return(n||lt(t)).catch(console.error),e.fid}(e),getToken:t=>dt(e,t)}};_e._registerComponent(new p(gt,mt,"PUBLIC")),_e._registerComponent(new p("installations-internal",vt,"PRIVATE")),_e.registerVersion("@firebase/installations",P);const yt="0.5.0",bt="FB-PERF-TRACE-MEASURE",_t="@firebase/performance/config",wt="@firebase/performance/configexpire";var Et,It,P="Performance";const Tt=new c("performance",P,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."}),St=new v(P);St.logLevel=l.INFO;let Nt,Ot;class At{constructor(t){if(!(this.window=t))throw Tt.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(t){this.performance&&this.performance.mark&&this.performance.mark(t)}measure(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)}getEntriesByType(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]}getEntriesByName(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?"indexedDB"in self&&null!=indexedDB||(St.info("IndexedDB is not supported by current browswer"),!1):(St.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(t,n){if(this.PerformanceObserver){const e=new this.PerformanceObserver(t=>{for(const e of t.getEntries())n(e)});e.observe({entryTypes:[t]})}}static getInstance(){return void 0===Nt&&(Nt=new At(Ot)),Nt}}let kt;function Ct(e,n){var t=e.length-n.length;if(t<0||1<t)throw Tt.create("invalid String merger input");const r=[];for(let t=0;t<e.length;t++)r.push(e.charAt(t)),n.length>t&&r.push(n.charAt(t));return r.join("")}let Pt;class Rt{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Ct("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Ct("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===Pt&&(Pt=new Rt),Pt}}(P=Et=Et||{})[P.UNKNOWN=0]="UNKNOWN",P[P.VISIBLE=1]="VISIBLE",P[P.HIDDEN=2]="HIDDEN";const Mt=["firebase_","google_","ga_"],jt=new RegExp("^[a-zA-Z]\\w*$");function Bt(){switch(At.getInstance().document.visibilityState){case"visible":return Et.VISIBLE;case"hidden":return Et.HIDDEN;default:return Et.UNKNOWN}}function Dt(t){t=null===(t=t.options)||void 0===t?void 0:t.appId;if(!t)throw Tt.create("no app id");return t}const Lt="0.0.1",Ut={loggingEnabled:!0},qt="FIREBASE_INSTALLATIONS_AUTH";function xt(t,e){var r,i,n=function(){const t=At.getInstance().localStorage;if(t){var e=t.getItem(wt);if(e&&function(t){return Number(t)>Date.now()}(e)){e=t.getItem(_t);if(e)try{return JSON.parse(e)}catch(t){return}}}}();return n?($t(n),Promise.resolve()):(i=e,function(t){const e=t.getToken();return e.then(t=>{}),e}((r=t).installations).then(t=>{var e=function(t){if(!(t=null===(t=t.options)||void 0===t?void 0:t.projectId))throw Tt.create("no project id");return t}(r.app),n=function(t){if(!(t=null===(t=t.options)||void 0===t?void 0:t.apiKey))throw Tt.create("no api key");return t}(r.app),t=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${e}/namespaces/fireperf:fetch?key=${n}`,{method:"POST",headers:{Authorization:`${qt} ${t}`},body:JSON.stringify({app_instance_id:i,app_instance_id_token:t,app_id:Dt(r.app),app_version:yt,sdk_version:Lt})});return fetch(t).then(t=>{if(t.ok)return t.json();throw Tt.create("RC response not ok")})}).catch(()=>{St.info(Ft)}).then($t).then(t=>function(t){const e=At.getInstance().localStorage;t&&e&&(e.setItem(_t,JSON.stringify(t)),e.setItem(wt,String(Date.now()+60*Rt.getInstance().configTimeToLive*60*1e3)))}(t),()=>{}))}const Ft="Could not fetch config, will use default configs";function $t(t){if(!t)return t;const e=Rt.getInstance();var n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=Ut.loggingEnabled,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=Ht(e.tracesSamplingRate),e.logNetworkAfterSampling=Ht(e.networkRequestsSamplingRate),t}function Ht(t){return Math.random()<=t}let Vt=1,Kt;function Wt(t){var e;return Vt=2,Kt=Kt||(e=t,function(){const n=At.getInstance().document;return new Promise(t=>{if(n&&"complete"!==n.readyState){const e=()=>{"complete"===n.readyState&&(n.removeEventListener("readystatechange",e),t())};n.addEventListener("readystatechange",e)}else t()})}().then(()=>function(t){const e=t.getId();return e.then(t=>{kt=t}),e}(e.installations)).then(t=>xt(e,t)).then(()=>zt(),()=>zt())),Kt}function zt(){Vt=3}const Gt=1e4,Jt=3,Yt=1e3;let Zt=Jt,Qt=[],Xt=!1;function te(t){setTimeout(()=>{if(0!==Zt)return Qt.length?void function(){const t=Qt.splice(0,Yt),e=t.map(t=>({source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)})),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Rt.getInstance().logSource,log_event:e};!function(t,r){return function(t){var e=Rt.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then(t=>(t.ok||St.info("Call to Firebase backend failed."),t.json())).then(t=>{var e=Number(t.nextRequestWaitMillis);let n=Gt;isNaN(e)||(n=Math.max(e,n));t=t.logResponseDetails;Array.isArray(t)&&0<t.length&&"RETRY_REQUEST_LATER"===t[0].responseAction&&(Qt=[...r,...Qt],St.info("Retry transport request later.")),Zt=Jt,te(n)})}(n,t).catch(()=>{Qt=[...t,...Qt],Zt--,St.info(`Tries left: ${Zt}.`),te(Gt)})}():te(Gt)},t)}function ee(e){return(...t)=>{!function(t){if(!t.eventTime||!t.message)throw Tt.create("invalid cc log");Qt=[...Qt,t]}({message:e(...t),eventTime:Date.now()})}}let ne;function re(t,e){ne=ne||ee(ae),ne(t,e)}function ie(t){var e=Rt.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&At.getInstance().requiredApisAvailable()&&(t.isAuto&&Bt()!==Et.VISIBLE||(3===Vt?oe(t):Wt(t.performanceController).then(()=>oe(t),()=>oe(t))))}function oe(t){var e;!kt||(e=Rt.getInstance()).loggingEnabled&&e.logTraceAfterSampling&&setTimeout(()=>re(t,1),0)}function ae(t,e){return 0===e?(e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},e={application_info:se(t.performanceController.app),network_request_metric:e},JSON.stringify(e)):function(t){const e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);t={application_info:se(t.performanceController.app),trace_metric:e};return JSON.stringify(t)}(t)}function se(t){return{google_app_id:Dt(t),app_instance_id:kt,web_app_info:{sdk_version:yt,page_url:At.getInstance().getUrl(),service_worker_status:"serviceWorker"in(t=At.getInstance().navigator)?t.serviceWorker.controller?2:3:1,visibility_state:Bt(),effective_connection_type:function(){var t=At.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}()},application_process_state:0}}const ce=["_fp","_fcp","_fid"];class ue{constructor(t,e,n=!1,r){this.performanceController=t,this.name=e,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=At.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=r||`${bt}-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw Tt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw Tt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),ie(this)}record(t,e,n){if(t<=0)throw Tt.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw Tt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics)for(const r of Object.keys(n.metrics))isNaN(Number(n.metrics[r]))||(this.counters[r]=Number(Math.floor(n.metrics[r])));ie(this)}incrementMetric(t,e=1){void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)}putMetric(t,e){if(n=t,r=this.name,0===n.length||100<n.length||!(r&&r.startsWith("_wt_")&&-1<ce.indexOf(n))&&n.startsWith("_"))throw Tt.create("invalid custom metric name",{customMetricName:t});var n,r;this.counters[t]=(t=e,(e=Math.floor(t))<t&&St.info(`Metric value should be an Integer, setting the value as : ${e}.`),e)}getMetric(t){return this.counters[t]||0}putAttribute(t,e){var n,r,i=!(0===(n=t).length||40<n.length)&&(!Mt.some(t=>n.startsWith(t))&&!!n.match(jt)),r=0!==(r=e).length&&r.length<=100;if(i&&r)this.customAttributes[t]=e;else{if(!i)throw Tt.create("invalid attribute name",{attributeName:t});if(!r)throw Tt.create("invalid attribute value",{attributeValue:e})}}getAttribute(t){return this.customAttributes[t]}removeAttribute(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(t){this.startTimeUs=t}setDuration(t){this.durationUs=t}calculateTraceMetrics(){var t=this.api.getEntriesByName(this.traceMeasure),t=t&&t[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(t,e,n,r){var i=At.getInstance().getUrl();if(i){const o=new ue(t,"_wt_"+i,!0);i=Math.floor(1e3*At.getInstance().getTimeOrigin());o.setStartTime(i),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd)));n&&((e=n.find(t=>"first-paint"===t.name))&&e.startTime&&o.putMetric("_fp",Math.floor(1e3*e.startTime)),(n=n.find(t=>"first-contentful-paint"===t.name))&&n.startTime&&o.putMetric("_fcp",Math.floor(1e3*n.startTime)),r&&o.putMetric("_fid",Math.floor(1e3*r))),ie(o)}}static createUserTimingTrace(t,e){ie(new ue(t,e,!1,e))}}function le(t,e){const n=e;var r,i;n&&void 0!==n.responseStart&&(i=At.getInstance().getTimeOrigin(),r=Math.floor(1e3*(n.startTime+i)),e=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,i=Math.floor(1e3*(n.responseEnd-n.startTime)),function(t){const e=Rt.getInstance();var n,r,i;e.instrumentationEnabled&&(n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0],n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout(()=>re(t,0),0))}({performanceController:t,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:r,timeToResponseInitiatedUs:e,timeToResponseCompletedUs:i}))}const pe=5e3;function fe(t){kt&&(setTimeout(()=>function(n){const t=At.getInstance(),r=t.getEntriesByType("navigation"),i=t.getEntriesByType("paint");if(t.onFirstInputDelay){let e=setTimeout(()=>{ue.createOobTrace(n,r,i),e=void 0},pe);t.onFirstInputDelay(t=>{e&&(clearTimeout(e),ue.createOobTrace(n,r,i,t))})}else ue.createOobTrace(n,r,i)}(t),0),setTimeout(()=>function(e){const t=At.getInstance(),n=t.getEntriesByType("resource");for(const r of n)le(e,r);t.setupObserver("resource",t=>le(e,t))}(t),0),setTimeout(()=>function(e){const t=At.getInstance(),n=t.getEntriesByType("measure");for(const r of n)de(e,r);t.setupObserver("measure",t=>de(e,t))}(t),0))}function de(t,e){const n=e.name;n.substring(0,bt.length)!==bt&&ue.createUserTimingTrace(t,n)}class he{constructor(t,e){this.app=t,this.installations=e,this.initialized=!1}_init(t){this.initialized||(void 0!==(null==t?void 0:t.dataCollectionEnabled)&&(this.dataCollectionEnabled=t.dataCollectionEnabled),void 0!==(null==t?void 0:t.instrumentationEnabled)&&(this.instrumentationEnabled=t.instrumentationEnabled),At.getInstance().requiredApisAvailable()?new Promise(function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}).then(t=>{t&&(Xt||(te(5500),Xt=!0),Wt(this).then(()=>fe(this),()=>fe(this)),this.initialized=!0)}).catch(t=>{St.info(`Environment doesn't support IndexedDB: ${t}`)}):St.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(t){Rt.getInstance().instrumentationEnabled=t}get instrumentationEnabled(){return Rt.getInstance().instrumentationEnabled}set dataCollectionEnabled(t){Rt.getInstance().dataCollectionEnabled=t}get dataCollectionEnabled(){return Rt.getInstance().dataCollectionEnabled}}const ge="[DEFAULT]";const me=(t,{options:e})=>{var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations-internal").getImmediate();if(n.name!==ge)throw Tt.create("FB not default");if("undefined"==typeof window)throw Tt.create("no window");t=window,Ot=t;const i=new he(n,r);return i._init(e),i};_e._registerComponent(new p("performance",me,"PUBLIC")),_e.registerVersion("@firebase/performance","0.5.0");class ve{constructor(t,e){this.app=t,this._delegate=e}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(t){this._delegate.instrumentationEnabled=t}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(t){this._delegate.dataCollectionEnabled=t}trace(t){return e=this._delegate,n=t,e=(t=e)&&t._delegate?t._delegate:t,new ue(e,n);var e,n}}function ye(t){var e=t.getProvider("app-compat").getImmediate(),t=t.getProvider("performance").getImmediate();return new ve(e,t)}(It=e.default).INTERNAL.registerComponent(new p("performance-compat",ye,"PUBLIC")),It.registerVersion("@firebase/performance-compat","0.1.0")}.apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-performance-compat.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-performance-compat.js.map
