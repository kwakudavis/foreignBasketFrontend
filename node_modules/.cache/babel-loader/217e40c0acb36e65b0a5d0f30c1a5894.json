{"ast":null,"code":"import _objectSpread from\"/Users/davis/Desktop/Nonsao/testEnv/foreignBasketFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/davis/Desktop/Nonsao/testEnv/foreignBasketFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/davis/Desktop/Nonsao/testEnv/foreignBasketFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/Users/davis/Desktop/Nonsao/testEnv/foreignBasketFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/davis/Desktop/Nonsao/testEnv/foreignBasketFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/davis/Desktop/Nonsao/testEnv/foreignBasketFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/davis/Desktop/Nonsao/testEnv/foreignBasketFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from\"react\";import{Field,reduxForm}from\"redux-form\";//import Auth from \"./Auth/Auth\";\nimport _ from\"lodash\";import GoogleButton from\"react-google-button\";import*as firebaseAuthSource from\"firebase/auth\";import{GoogleAuthProvider,onAuthStateChanged}from\"firebase/auth\";import\"./index.css\";import{connect}from\"react-redux\";import{signIn,signOut,updateUserDetailsInStore,setCartModalState}from\"./actions\";import{doc,getDoc}from\"firebase/firestore\";import{db,auth}from\"./firebase/firebaseConfig\";import{showModal}from\"./components/isModalActive\";/////// Set up providers to be used\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var googleprovider=new GoogleAuthProvider();////// Set scopes for google auth provider\ngoogleprovider.addScope(\"profile\");googleprovider.addScope(\"email\");var Accountpage=/*#__PURE__*/function(_React$Component){_inherits(Accountpage,_React$Component);var _super=_createSuper(Accountpage);function Accountpage(props){var _this;_classCallCheck(this,Accountpage);_this=_super.call(this,props);_this.triggeredOnChange=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(user){var addressV,mobileV,details;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:// this.renderOutputAccountPageBasedOnState();\n///////Update is Logged in State with true if user is logged in\nif(user!==null){/////\n_this.props.signIn(user);/////// Fetch user's stored details and stoer in globalstate\n///user.address = addressV;\n// user.mobile = mobileV;\n_this.setState({user:user});}//////Update is Logged in State with false if user is not logged in\nelse{_this.props.signOut();_this.setState({user:null});// console.log(this.props.loginState);\n}case 1:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.updateUserDetails=function(formData){////Update phone number and address where user id equals the id provided\n//e.preventDefault();\ntry{formData.uid=_this.state.user.uid;console.log(\"updating details\",formData);if(!formData.mobile){formData.mobile=null;}if(!formData.address){formData.address=null;}//console.log(\"form data:\", this.props);\n_this.props.updateUserDetailsInStore(formData);alert(\"Successfully updated\");}catch(err){console.log(err);}};_this.renderOutputAccountPageBasedOnState=function(loginState){/////If user is logged in, render account details and sign out button\nif(loginState){// console.log(\"rendered sign out/render\");\nreturn/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"googleSignInandoutbuttonsDiv\",children:/*#__PURE__*/_jsx(GoogleButton,{label:\"Sign Out\",type:\"dark\",onClick:function onClick(){//console.log(firebaseAuthSource.signOut(auth));\nfirebaseAuthSource.signOut(auth);}})}),/*#__PURE__*/_jsx(\"div\",{className:\"accountpageForm\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"ui form account details\",id:\"accountdetails\",onSubmit:_this.props.handleSubmit(_this.updateUserDetails),children:[/*#__PURE__*/_jsx(Field,{style:{color:\"black\"},name:\"name\",component:_this.renderInput,label:\"Full Name\",placeholder:loginState.displayName}),/*#__PURE__*/_jsx(Field,{name:\"mobile\",component:_this.renderInput,label:\"Phone Number\",placeholder:_this.props.loginState.mobile}),/*#__PURE__*/_jsx(Field,{name:\"address\",component:_this.renderInput,label:\"Address\",placeholder:_this.props.loginState.address}),/*#__PURE__*/_jsx(\"button\",{className:\"ui button primary\",type:\"submit\",children:\"Update\"})]})})]});//////If user is logged out, render sign in Button\n}else{console.log(\"rendre sign in button\");return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"googleSignInandoutbuttonsDiv \",children:/*#__PURE__*/_jsx(GoogleButton,{type:\"light\",onClick:function onClick(){try{firebaseAuthSource.signInWithPopup(auth,googleprovider).then(function(result){// var user = result.user;\n});}catch(err){console.log(err);}}})})});}};_this.renderInput=function(_ref2){var input=_ref2.input,label=_ref2.label,meta=_ref2.meta,placeholder=_ref2.placeholder,value=_ref2.value;return/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{children:label}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},input),{},{placeholder:placeholder,value:value}))]});};_this.state={userRecords:{mobile:222,address:\"wers\"}};return _this;}_createClass(Accountpage,[{key:\"componentDidMount\",value:function componentDidMount(){console.log(auth.authStateSubscription.auth.authStateSubscription.observer);onAuthStateChanged(auth,this.triggeredOnChange);}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:showModal(this.props.cartModalActive,this.props.setCartModalState,this.props.cart)}),this.renderOutputAccountPageBasedOnState(this.state.user)]});}}]);return Accountpage;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{loginState:state.loginState,cartModalActive:state.cartModalActive,cart:state.cart};};var firstWrap=connect(mapStateToProps,{signIn:signIn,signOut:signOut,updateUserDetailsInStore:updateUserDetailsInStore,setCartModalState:setCartModalState})(Accountpage);export default reduxForm({form:\"accountDetails\"})(firstWrap);","map":{"version":3,"names":["React","Field","reduxForm","_","GoogleButton","firebaseAuthSource","GoogleAuthProvider","onAuthStateChanged","connect","signIn","signOut","updateUserDetailsInStore","setCartModalState","doc","getDoc","db","auth","showModal","googleprovider","addScope","Accountpage","props","triggeredOnChange","user","setState","updateUserDetails","formData","uid","state","console","log","mobile","address","alert","err","renderOutputAccountPageBasedOnState","loginState","handleSubmit","color","renderInput","displayName","signInWithPopup","then","result","input","label","meta","placeholder","value","userRecords","authStateSubscription","observer","cartModalActive","cart","Component","mapStateToProps","firstWrap","form"],"sources":["/Users/davis/Desktop/Nonsao/testEnv/foreignBasketFrontend/src/Accountpage.js"],"sourcesContent":["import React from \"react\";\r\nimport { Field, reduxForm } from \"redux-form\";\r\n//import Auth from \"./Auth/Auth\";\r\nimport _ from \"lodash\";\r\nimport GoogleButton from \"react-google-button\";\r\nimport * as firebaseAuthSource from \"firebase/auth\";\r\nimport { GoogleAuthProvider, onAuthStateChanged } from \"firebase/auth\";\r\nimport \"./index.css\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  signIn,\r\n  signOut,\r\n  updateUserDetailsInStore,\r\n  setCartModalState\r\n} from \"./actions\";\r\nimport { doc, getDoc } from \"firebase/firestore\";\r\nimport { db, auth } from \"./firebase/firebaseConfig\";\r\nimport { showModal } from \"./components/isModalActive\";\r\n\r\n/////// Set up providers to be used\r\nvar googleprovider = new GoogleAuthProvider();\r\n\r\n////// Set scopes for google auth provider\r\ngoogleprovider.addScope(\"profile\");\r\ngoogleprovider.addScope(\"email\");\r\n\r\nclass Accountpage extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = { userRecords: { mobile: 222, address: \"wers\" } };\r\n  }\r\n\r\n  triggeredOnChange = async (user) => {\r\n    // this.renderOutputAccountPageBasedOnState();\r\n\r\n    ///////Update is Logged in State with true if user is logged in\r\n    if (user !== null) {\r\n      /////\r\n      this.props.signIn(user);\r\n\r\n      /////// Fetch user's stored details and stoer in globalstate\r\n      var addressV;\r\n      var mobileV;\r\n      var details;\r\n\r\n      ///user.address = addressV;\r\n      // user.mobile = mobileV;\r\n      this.setState({ user: user });\r\n    }\r\n    //////Update is Logged in State with false if user is not logged in\r\n    else {\r\n      this.props.signOut();\r\n      this.setState({ user: null });\r\n      // console.log(this.props.loginState);\r\n    }\r\n  };\r\n\r\n  updateUserDetails = (formData) => {\r\n    ////Update phone number and address where user id equals the id provided\r\n    //e.preventDefault();\r\n    try {\r\n      formData.uid = this.state.user.uid;\r\n      console.log(\"updating details\", formData);\r\n      if (!formData.mobile) {\r\n        formData.mobile = null;\r\n      }\r\n      if (!formData.address) {\r\n        formData.address = null;\r\n      }\r\n      //console.log(\"form data:\", this.props);\r\n      this.props.updateUserDetailsInStore(formData);\r\n      alert(\"Successfully updated\");\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  renderOutputAccountPageBasedOnState = (loginState) => {\r\n    /////If user is logged in, render account details and sign out button\r\n    if (loginState) {\r\n      // console.log(\"rendered sign out/render\");\r\n\r\n      return (\r\n        <div>\r\n          <div className=\"googleSignInandoutbuttonsDiv\">\r\n            <GoogleButton\r\n              label=\"Sign Out\"\r\n              type=\"dark\"\r\n              onClick={() => {\r\n                //console.log(firebaseAuthSource.signOut(auth));\r\n                firebaseAuthSource.signOut(auth);\r\n              }}\r\n            />\r\n          </div>\r\n          <div className=\"accountpageForm\">\r\n            <form\r\n              className=\"ui form account details\"\r\n              id=\"accountdetails\"\r\n              onSubmit={this.props.handleSubmit(this.updateUserDetails)}\r\n            >\r\n              <Field\r\n                style={{ color: \"black\" }}\r\n                name=\"name\"\r\n                component={this.renderInput}\r\n                label=\"Full Name\"\r\n                placeholder={loginState.displayName}\r\n              />\r\n\r\n              <Field\r\n                name=\"mobile\"\r\n                component={this.renderInput}\r\n                label=\"Phone Number\"\r\n                placeholder={this.props.loginState.mobile}\r\n              />\r\n              <Field\r\n                name=\"address\"\r\n                component={this.renderInput}\r\n                label=\"Address\"\r\n                placeholder={this.props.loginState.address}\r\n              />\r\n\r\n              <button className=\"ui button primary\" type=\"submit\">\r\n                Update\r\n              </button>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      );\r\n\r\n      //////If user is logged out, render sign in Button\r\n    } else {\r\n      console.log(\"rendre sign in button\");\r\n      return (\r\n        <div>\r\n          <div className=\"googleSignInandoutbuttonsDiv \">\r\n            <GoogleButton\r\n              type=\"light\"\r\n              onClick={() => {\r\n                try {\r\n                  firebaseAuthSource\r\n                    .signInWithPopup(auth, googleprovider)\r\n                    .then(function (result) {\r\n                      // var user = result.user;\r\n                    });\r\n                } catch (err) {\r\n                  console.log(err);\r\n                }\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  };\r\n  componentDidMount() {\r\n    console.log(auth.authStateSubscription.auth.authStateSubscription.observer);\r\n    onAuthStateChanged(auth, this.triggeredOnChange);\r\n  }\r\n\r\n  renderInput = ({ input, label, meta, placeholder, value }) => {\r\n    return (\r\n      <div className=\"field\">\r\n        <label>{label}</label>\r\n        <input {...input} placeholder={placeholder} value={value} />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div>\r\n          {showModal(\r\n            this.props.cartModalActive,\r\n            this.props.setCartModalState,\r\n            this.props.cart\r\n          )}\r\n        </div>\r\n        {this.renderOutputAccountPageBasedOnState(this.state.user)}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    loginState: state.loginState,\r\n    cartModalActive: state.cartModalActive,\r\n    cart: state.cart\r\n  };\r\n};\r\n\r\nvar firstWrap = connect(mapStateToProps, {\r\n  signIn,\r\n  signOut,\r\n  updateUserDetailsInStore,\r\n  setCartModalState\r\n})(Accountpage);\r\n\r\nexport default reduxForm({\r\n  form: \"accountDetails\"\r\n})(firstWrap);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}